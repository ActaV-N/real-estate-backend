let mongoose,SectorSchema,LocationSchema;_236‍.x([["default",()=>_236‍.o]]);_236‍.w("mongoose",[["default",["mongoose"],function(v){mongoose=v}]]);_236‍.w("./Sector",[["SectorSchema",["SectorSchema"],function(v){SectorSchema=v}]]);_236‍.w("./Location",[["LocationSchema",["LocationSchema"],function(v){LocationSchema=v}]]);



const { Schema, model } = mongoose;

const BuildingSchema = new Schema({
	creationDate: {
		type: Date,
		default: new Date(),
	},
	buildingInfo: {
		image: String,
		name: String,

		layer: Number,
		number: Number,

		saleArea: Number,
		realArea: Number,

		sectors: {
			basic: String,
			detail: String,
		},

		location: LocationSchema,
	},
	dealInfo: {
		trade: {
			price: Number,
			deposit: Number,
			monthly: Number,
			totalPrice: Number,
		},
		lease: {
			price: Number,
			deposit: Number,
			monthly: Number,
		},
		rights: Number,
	},
	partyInfo: {
		owner: String,
		ownerPhone: String,
		lessee: String,
		lesseePhone: String,
	},
});

BuildingSchema.pre('save', function(next) {
	const { trade } = this.dealInfo;
	if (trade) {
		trade.totalPrice = trade.price * this.buildingInfo.saleArea;
	}
	next();
});

_236‍.d(model('building', BuildingSchema));
