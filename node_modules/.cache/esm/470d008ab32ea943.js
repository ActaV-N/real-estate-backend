let Koa,KoaBody,ApolloServer,mongoose,resolvers,typeDefs;_b32‍.w("koa",[["default",["Koa"],function(v){Koa=v}]]);_b32‍.w("koa-bodyparser",[["default",["KoaBody"],function(v){KoaBody=v}]]);_b32‍.w("apollo-server-koa",[["ApolloServer",["ApolloServer"],function(v){ApolloServer=v}]]);_b32‍.w("mongoose",[["default",["mongoose"],function(v){mongoose=v}]]);_b32‍.w("./graphql",[["resolvers",["resolvers"],function(v){resolvers=v}],["typeDefs",["typeDefs"],function(v){typeDefs=v}]]);require('dotenv').config();









const app = new Koa();
const PORT = process.env.PORT || 4000;

app.use(KoaBody());

// Database connection
const db = mongoose.connection;
mongoose.connect(process.env.MONGO_URI, {
	useNewUrlParser: true,
	useUnifiedTopology: true,
	useFindAndModify: false,
});
db.on('connected', () => console.log('Database connected'));
db.on('error', err => _b32‍.g.console.log(err));

const server = new ApolloServer({
	typeDefs,
	resolvers,
	context: ({ ctx }) => {
		const token = ctx.cookies.get('access_token');
		_b32‍.g.console.log(token);

		// TODO: send a token as a part of context to check if requset was authenticated.
		return { ctx };
	},
});
server.applyMiddleware({ app });

app.listen(PORT, () => {
	console.log(`🚀  Server ready at localhost:${PORT}`);
});
